#pragma once
#ifndef __CRITICALSECTION_H__
#define __CRITICALSECTION_H__
//////////////////////////////////////////////////////////////////////////
class ATL_NO_VTABLE CNonCopyable
{
private:

	//////////////////////////////////////////////////////////////////////////
	CNonCopyable(CONST CNonCopyable& x);
	CNonCopyable& operator=(CONST CNonCopyable& x);
	//////////////////////////////////////////////////////////////////////////

public:

	//////////////////////////////////////////////////////////////////////////
	CNonCopyable(VOID)
	{

	};
	//////////////////////////////////////////////////////////////////////////

};
//////////////////////////////////////////////////////////////////////////
class CriticalSection:
public CNonCopyable
{
protected:

	//////////////////////////////////////////////////////////////////////////
	// the critical section itself
	//////////////////////////////////////////////////////////////////////////
	mutable CRITICAL_SECTION												m_cs;
	//////////////////////////////////////////////////////////////////////////

public:

	//////////////////////////////////////////////////////////////////////////
	CriticalSection(VOID);
	~CriticalSection(VOID);
	VOID Lock(VOID);
	VOID Unlock(VOID);
	//////////////////////////////////////////////////////////////////////////

};
//////////////////////////////////////////////////////////////////////////
class ScopedCriticalSection:
public CNonCopyable
{
private:

	//////////////////////////////////////////////////////////////////////////
	// the Critical Section for this resource
	//////////////////////////////////////////////////////////////////////////
	CriticalSection & m_csResource;
	//////////////////////////////////////////////////////////////////////////

public:

	//////////////////////////////////////////////////////////////////////////
	ScopedCriticalSection(CriticalSection & csResource);
	~ScopedCriticalSection(VOID);
	//////////////////////////////////////////////////////////////////////////

};
//////////////////////////////////////////////////////////////////////////
#endif//__CRITICALSECTION_H__