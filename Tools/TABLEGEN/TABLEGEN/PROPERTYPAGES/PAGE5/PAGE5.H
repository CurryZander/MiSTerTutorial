#pragma once
#ifndef __PAGE5_H__
#define __PAGE5_H__
//////////////////////////////////////////////////////////////////////////
#include "../../HTL/HTLRESIZE.H"
#include "../../RESOURCEDEF.H"
//////////////////////////////////////////////////////////////////////////
#define GRNM_ASCII_TABLE_REGISTRY_SECTION									L"ASCII TABLE"
#define GRNM_ASCII_TABLE_TEXT_ENTRIES_REGISTRY_KEY							L"LAST TEXT ENTRIES"
#define GRNM_ASCII_TABLE_TEXT_DEFAULT										L""
#define GRNM_ASCII_TABLE_CHARACTERS_PER_LINE_KEY							L"CHARACTERS PER LINE"
#define GRNM_ASCII_TABLE_CHARACTERS_PER_LINE_DEFAULT						32
//////////////////////////////////////////////////////////////////////////
class CPropertyPage5 :
	public CResizablePropertyPageImpl<CPropertyPage5>
{

protected:

	//////////////////////////////////////////////////////////////////////////
	CEdit																m_TextEditBox;
	CString																m_TextString;
	//////////////////////////////////////////////////////////////////////////
	CEdit																m_CharactersPerLineBox;
	CStatic																m_CharactersPerLineText;
	DWORD																m_CharactersPerLine;
	//////////////////////////////////////////////////////////////////////////
	CString&															m_FileName;
	//////////////////////////////////////////////////////////////////////////

public:

	//////////////////////////////////////////////////////////////////////////
	typedef CPropertyPage5												thisClass;
	typedef CResizablePropertyPageImpl<CPropertyPage5>					baseClass;
	typedef CResizablePropertyPageImpl									baseClassNoParent;
	//////////////////////////////////////////////////////////////////////////
	enum { IDD = IDD_PAGE5 };
	//////////////////////////////////////////////////////////////////////////
	CPropertyPage5(CString& filename, ATL::_U_STRINGorID title = (LPCTSTR)NULL, bool IsExterior = false, bool EnableDoubleBuffer = false);
	~CPropertyPage5(VOID);
	//////////////////////////////////////////////////////////////////////////
	BOOL OnSetActive(VOID);
	LRESULT OnInitDialog(HWND hWnd, LPARAM lParam);
	INT_PTR OnWizardFinish(VOID);
	BOOL OnQueryCancel(VOID);
	//////////////////////////////////////////////////////////////////////////

	//////////////////////////////////////////////////////////////////////////
	BEGIN_MSG_MAP_EX(baseClassNoParent)
		MSG_WM_INITDIALOG(OnInitDialog)
		CHAIN_MSG_MAP(baseClass)
		CHAIN_MSG_MAP(CDialogResize<thisClass>)
		REFLECT_NOTIFICATIONS()
	END_MSG_MAP()
	//////////////////////////////////////////////////////////////////////////
	BEGIN_DLGRESIZE_MAP_EX(thisClass)
		//////////////////////////////////////////////////////////////////////////
		DLGRESIZE_CONTROL_EX(IDC_EDIT_TEXT_INPUT, DLSZ_SIZE_X| DLSZ_SIZE_Y)
		DLGRESIZE_CONTROL_EX(IDC_EDIT_CHARACTERS_PER_LINE, DLSZ_SIZE_X | DLSZ_MOVE_Y)
		DLGRESIZE_CONTROL_EX(IDC_STATIC_CHARACTERS_PER_LINE_TEXT, DLSZ_MOVE_Y)
		//////////////////////////////////////////////////////////////////////////
	END_DLGRESIZE_MAP_EX()
	//////////////////////////////////////////////////////////////////////////

};
//////////////////////////////////////////////////////////////////////////
#endif//__PAGE5_H__