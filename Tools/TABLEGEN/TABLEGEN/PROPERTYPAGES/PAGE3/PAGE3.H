#pragma once
#ifndef __PAGE3_H__
#define __PAGE3_H__
//////////////////////////////////////////////////////////////////////////
#include "../../HTL/HTLRESIZE.H"
#include "../../RESOURCEDEF.H"
//////////////////////////////////////////////////////////////////////////
#define GRNM_BITMAP_REGISTRY_SECTION									L"BITMAP"
#define GRNM_BITMAP_TYPE_REGISTRY_KEY									L"LAST TYPE"
#define GRNM_BITMAP_PATH_REGISTRY_KEY									L"LAST PATH"
#define GRNM_BITMAP_TYPE_DEFAULT										1
#define GRNM_BITMAP_PATH_DEFAULT										L""
//////////////////////////////////////////////////////////////////////////
extern DWORD TABLE_TYPE_CHANGED;
//////////////////////////////////////////////////////////////////////////
class CPropertyPage3 :
	public CResizablePropertyPageImpl<CPropertyPage3>
{

protected:

	//////////////////////////////////////////////////////////////////////////
	CWindow																m_Display;
	//////////////////////////////////////////////////////////////////////////
	CString&															m_FileName;
	HBITMAP																m_Bitmap;
	//////////////////////////////////////////////////////////////////////////

public:

	//////////////////////////////////////////////////////////////////////////
	typedef CPropertyPage3												thisClass;
	typedef CResizablePropertyPageImpl<CPropertyPage3>					baseClass;
	typedef CResizablePropertyPageImpl									baseClassNoParent;
	//////////////////////////////////////////////////////////////////////////
	enum { IDD = IDD_PAGE3 };
	//////////////////////////////////////////////////////////////////////////
	CPropertyPage3(CString& filename, ATL::_U_STRINGorID title = (LPCTSTR)NULL, bool IsExterior = false, bool EnableDoubleBuffer = false);
	~CPropertyPage3(VOID);
	//////////////////////////////////////////////////////////////////////////
	BOOL OnSetActive(VOID);
	LRESULT OnInitDialog(HWND hWnd, LPARAM lParam);
	BOOL OnQueryCancel(VOID);
	//////////////////////////////////////////////////////////////////////////
	BOOL OnPaint(HDC dc);
	LRESULT OnBnClickedButtonLeft(WORD /*wNotifyCode*/, WORD /*wID*/, HWND /*hWndCtl*/, BOOL& /*bHandled*/);
	LRESULT OnBnClickedButtonRight(WORD /*wNotifyCode*/, WORD /*wID*/, HWND /*hWndCtl*/, BOOL& /*bHandled*/);
	//////////////////////////////////////////////////////////////////////////
	BEGIN_MSG_MAP_EX(baseClassNoParent)
		MSG_WM_INITDIALOG(OnInitDialog)
		MSG_WM_PAINT(OnPaint)
		CHAIN_MSG_MAP(baseClass)
		CHAIN_MSG_MAP(CDialogResize<thisClass>)
		REFLECT_NOTIFICATIONS()
	END_MSG_MAP()
	//////////////////////////////////////////////////////////////////////////
	BEGIN_DLGRESIZE_MAP_EX(thisClass)
		//////////////////////////////////////////////////////////////////////////
		DLGRESIZE_CONTROL_EX(IDC_STATIC_PICTURE, NULL)
		DLGRESIZE_CONTROL_EX(IDC_BUTTON_LEFT, DLSZ_MOVE_X)
		DLGRESIZE_CONTROL_EX(IDC_BUTTON_RIGHT, DLSZ_MOVE_X)
		//////////////////////////////////////////////////////////////////////////
	END_DLGRESIZE_MAP_EX()
	//////////////////////////////////////////////////////////////////////////
};
//////////////////////////////////////////////////////////////////////////
#endif//__PAGE3_H__