#include "GRNMPCH.H"
#include "SAVELOAD.H"
//////////////////////////////////////////////////////////////////////////
#include <vector>
#include <sstream>
#include <fstream>
#include <string>
//////////////////////////////////////////////////////////////////////////
BOOL ReadLines(CString& FilePath,CGrowableArray<CString>& OutputStringList)
{
	//////////////////////////////////////////////////////////////////////////
	DWORD VolumeSize=0;
	//////////////////////////////////////////////////////////////////////////
	{
		//////////////////////////////////////////////////////////////////////////
		WCHAR vol[4];
		std::wifstream InputFile(FilePath.GetBuffer(FilePath.GetLength()));
		FilePath.ReleaseBuffer();
		InputFile.read(vol,4);
		vol[3]=NULL;
		if(GetVolumeInformationW(vol,nullptr,NULL,nullptr,&VolumeSize,nullptr,nullptr,NULL)==0)
		{
			return FALSE;
		}
		//////////////////////////////////////////////////////////////////////////

	}
	//////////////////////////////////////////////////////////////////////////
	std::wifstream InputFile(FilePath.GetBuffer(FilePath.GetLength()));
	FilePath.ReleaseBuffer();
    if(InputFile){

		//////////////////////////////////////////////////////////////////////////
		CString OutputString;
		//////////////////////////////////////////////////////////////////////////
		OutputStringList.RemoveAll();
		//////////////////////////////////////////////////////////////////////////
		while(InputFile.getline(OutputString.GetBuffer(VolumeSize),VolumeSize,L'\n'))
		{
			OutputString.ReleaseBuffer();
			OutputStringList.Add(OutputString);
		}
		//////////////////////////////////////////////////////////////////////////
		InputFile.close();
		//////////////////////////////////////////////////////////////////////////
		return TRUE;
		//////////////////////////////////////////////////////////////////////////

	}
	//////////////////////////////////////////////////////////////////////////
	return FALSE;
	//////////////////////////////////////////////////////////////////////////

}
//////////////////////////////////////////////////////////////////////////
BOOL WriteLines(CString& FilePath,CGrowableArray<CString>& OutputStringList)
{
	//////////////////////////////////////////////////////////////////////////
	std::wofstream OutputFile(FilePath.GetBuffer(FilePath.GetLength()),ios::trunc|ios::out);
	FilePath.ReleaseBuffer();
	//////////////////////////////////////////////////////////////////////////
    if(OutputFile){

		//////////////////////////////////////////////////////////////////////////
		UINT64 ArraySize=OutputStringList.GetSize();
		//////////////////////////////////////////////////////////////////////////
		for(UINT64 j=0;j<ArraySize;j++)
		{
			CString& OutputString=OutputStringList[j];
			OutputFile<<OutputString.GetBuffer(OutputString.GetLength())<<"\n";
			OutputString.ReleaseBuffer();
		}
		//////////////////////////////////////////////////////////////////////////
		OutputFile.close();
		//////////////////////////////////////////////////////////////////////////
		return TRUE;
		//////////////////////////////////////////////////////////////////////////

	}
	//////////////////////////////////////////////////////////////////////////
	return FALSE;
	//////////////////////////////////////////////////////////////////////////

}
//////////////////////////////////////////////////////////////////////////
